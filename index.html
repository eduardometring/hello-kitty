<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Hello Kitty Platformer</title>
<link rel="icon" type="image/png" href="images/pngimg.com - hello_kitty_PNG16.png" />
<style>
  body {
    margin: 0;
    background: #ffd1e8;
    font-family: Arial, sans-serif;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }

  #game-container {
    position: relative;
    width: 100vw;
    height: 56.25vw; /* propor√ß√£o 16:9 */
    max-width: 640px;
    max-height: 360px;
  }

  canvas {
    display: block;
    width: 100%;
    height: 100%;
    background: linear-gradient(#9bd3ff, #eaf7ff);
    border: 4px solid #ff7fbf;
    border-radius: 12px;
  }

  .hud {
    color: #7a1f5c;
    margin-top: 4px;
    font-size: 16px;
    text-align: center;
  }

  /* Bot√µes mobile */
  #mobile-controls {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 80px;
    pointer-events: none;
  }

  #leftBtn, #rightBtn, #upBtn {
    width: 60px;
    height: 60px;
    font-size: 24px;
    border: none;
    border-radius: 12px;
    background: #ff7fbf88;
    color: #fff;
    pointer-events: auto;
  }

  #leftBtn { position: absolute; left: 10px; bottom: 10px; }
  #rightBtn { position: absolute; left: 80px; bottom: 10px; }
  #upBtn { position: absolute; right: 10px; bottom: 10px; }

  #mobile-controls button:active { background: #ff4fa3; }
</style>
</head>
<body>

<div id="game-container">
  <canvas id="game"></canvas>
  <div id="mobile-controls">
    <button id="leftBtn">‚Üê</button>
    <button id="rightBtn">‚Üí</button>
    <button id="upBtn">‚Üë</button>
  </div>
</div>
<div class="hud">‚Üê ‚Üí mover | ‚Üë pular</div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

// --------- RESPONSIVO ---------
function resizeCanvas() {
  canvas.width = canvas.clientWidth;
  canvas.height = canvas.clientHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

// --------- CONFIGURA√á√ÉO ---------
const GRAVITY = 0.6;
const FRICTION = 0.8;

const player = { x:50, y:250, w:28, h:28, vx:0, vy:0, speed:3.2, jump:11, onGround:false };
const playerImg = new Image();
playerImg.src = 'images/pngimg.com - hello_kitty_PNG16.png';

const worldWidth = 3500;

const platforms = [
  {x:0,y:320,w:500,h:40},{x:650,y:320,w:600,h:40},{x:1400,y:320,w:400,h:40},
  {x:1900,y:320,w:600,h:40},{x:2700,y:320,w:700,h:40},{x:120,y:260,w:140,h:14},
  {x:300,y:220,w:140,h:14},{x:520,y:260,w:140,h:14},{x:740,y:200,w:140,h:14},
  {x:980,y:240,w:140,h:14},{x:1200,y:200,w:140,h:14},{x:1500,y:260,w:140,h:14},
  {x:1700,y:220,w:140,h:14},{x:2100,y:200,w:140,h:14},{x:2350,y:240,w:140,h:14},
  {x:2600,y:200,w:140,h:14},{x:3000,y:240,w:140,h:14}
];

const goal = { x: worldWidth-120, y:200, w:20, h:120 };

let gameWon=false, gameOver=false, score=0, lives=3;

const collectibles = [
  {x:160,y:230,r:6,collected:false},{x:340,y:190,r:6,collected:false},{x:520,y:150,r:6,collected:false},
  {x:760,y:230,r:6,collected:false},{x:960,y:190,r:6,collected:false},{x:1200,y:230,r:6,collected:false},
  {x:1400,y:190,r:6,collected:false},{x:1650,y:150,r:6,collected:false},{x:1900,y:230,r:6,collected:false},
  {x:2200,y:190,r:6,collected:false},{x:2500,y:230,r:6,collected:false},{x:2800,y:190,r:6,collected:false}
];

const enemies = [
  {x:420,y:292,w:26,h:26,vx:1.2,minX:380,maxX:560,vy:0,onGround:false,alive:true},
  {x:820,y:292,w:26,h:26,vx:1.2,minX:780,maxX:980,vy:0,onGround:false,alive:true},
  {x:1500,y:292,w:26,h:26,vx:1.2,minX:1450,maxX:1700,vy:0,onGround:false,alive:true},
  {x:2100,y:292,w:26,h:26,vx:1.2,minX:2050,maxX:2300,vy:0,onGround:false,alive:true},
  {x:2900,y:292,w:26,h:26,vx:1.2,minX:2850,maxX:3150,vy:0,onGround:false,alive:true}
];

// --------- CONTROLES ---------
const keys = {};
window.addEventListener('keydown', e=>keys[e.key]=true);
window.addEventListener('keyup', e=>keys[e.key]=false);

const touchKeys = {ArrowLeft:false, ArrowRight:false, ArrowUp:false};
['leftBtn','rightBtn','upBtn'].forEach(id=>{
  const keyMap = id==='leftBtn'?'ArrowLeft':id==='rightBtn'?'ArrowRight':'ArrowUp';
  const btn = document.getElementById(id);

  const start = e=>{ e.preventDefault(); touchKeys[keyMap]=true; };
  const end   = e=>{ e.preventDefault(); touchKeys[keyMap]=false; };

  btn.addEventListener('pointerdown', start);
  btn.addEventListener('pointerup', end);
  btn.addEventListener('pointerleave', end);
  btn.addEventListener('touchstart', start, {passive:false});
  btn.addEventListener('touchend', end);
});

document.body.addEventListener('touchmove', e=>e.preventDefault(), {passive:false});

// --------- FUN√á√ïES ---------
function rectsOverlap(a,b){ return a.x<a.x+b.w && a.x+a.w>b.x && a.y<a.y+b.h && a.y+a.h>b.y; }

function update(){
  if(gameWon||gameOver) return;

  // Player controles
  if(keys['ArrowLeft']||touchKeys.ArrowLeft) player.vx=-player.speed;
  if(keys['ArrowRight']||touchKeys.ArrowRight) player.vx=player.speed;
  if((keys['ArrowUp']||touchKeys.ArrowUp)&&player.onGround){player.vy=-player.jump; player.onGround=false;}

  player.vy+=GRAVITY; player.x+=player.vx; player.y+=player.vy; player.vx*=FRICTION;
  player.x=Math.max(0,Math.min(worldWidth-player.w,player.x));

  player.onGround=false;
  for(const p of platforms){
    if(player.x<p.x+p.w && player.x+player.w>p.x && player.y<p.y+p.h && player.y+player.h>p.y){
      const prevY=player.y-player.vy;
      if(player.vy>0 && prevY+player.h<=p.y){player.y=p.y-player.h; player.vy=0; player.onGround=true;}
      else if(player.vy<0 && prevY>=p.y+p.h){player.y=p.y+p.h; player.vy=0;}
    }
  }

  for(const c of collectibles){
    if(!c.collected){
      const dx=(player.x+player.w/2)-c.x;
      const dy=(player.y+player.h/2)-c.y;
      if(Math.hypot(dx,dy)<c.r+12){c.collected=true; score++;}
    }
  }

  for(const e of enemies){
    if(!e.alive) continue;
    e.vy+=GRAVITY; e.x+=e.vx; e.y+=e.vy;

    if(e.x<e.minX){e.x=e.minX; e.vx=Math.abs(e.vx);}
    if(e.x+e.w>e.maxX){e.x=e.maxX-e.w; e.vx=-Math.abs(e.vx);}

    e.onGround=false;
    for(const p of platforms){
      if(e.x<p.x+p.w && e.x+e.w>p.x && e.y<p.y+p.h && e.y+e.h>p.y){
        const prevY=e.y-e.vy;
        if(e.vy>0 && prevY+e.h<=p.y){e.y=p.y-e.h; e.vy=0; e.onGround=true;}
        else if(e.vy<0 && prevY>=p.y+p.h){e.y=p.y+p.h; e.vy=0;}
      }
    }

    if(e.onGround && Math.random()<0.01) e.vy=-6;

    if(rectsOverlap(player,e)){
      if(player.vy>0 && player.y+player.h-player.vy<=e.y){e.alive=false; player.vy=-8;}
      else{
        lives--;
        if(lives<=0) gameOver=true;
        else {player.x=50; player.y=250; player.vx=0; player.vy=0;}
      }
    }
  }

  if(player.y>canvas.height){ lives--; if(lives<=0) gameOver=true; else {player.x=50; player.y=250; player.vx=0; player.vy=0;} }

  if(rectsOverlap(player,goal)) gameWon=true;
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const scaleX = canvas.width/640;
  const scaleY = canvas.height/360;
  const cameraX = Math.max(0, Math.min(player.x-320, worldWidth-640));
  ctx.save(); ctx.scale(scaleX,scaleY); ctx.translate(-cameraX,0);

  ctx.fillStyle='#ff9ad5'; for(const p of platforms) ctx.fillRect(p.x,p.y,p.w,p.h);
  for(const c of collectibles){ if(!c.collected){ ctx.fillStyle='#ff3b3b'; ctx.beginPath(); ctx.arc(c.x,c.y,c.r,0,Math.PI*2); ctx.fill(); ctx.fillStyle='#3aa655'; ctx.fillRect(c.x-2,c.y-c.r-4,4,6); } }
  ctx.fillStyle='#7a1f5c'; for(const e of enemies){if(e.alive)ctx.fillRect(e.x,e.y,e.w,e.h);}
  ctx.fillStyle='#ffffff'; ctx.fillRect(goal.x,goal.y,goal.w,goal.h);
  ctx.fillStyle='#ff4fa3'; ctx.fillRect(goal.x+goal.w,goal.y,30,20);

  ctx.drawImage(playerImg,player.x,player.y,player.w,player.h);
  ctx.restore();

  ctx.fillStyle='#7a1f5c'; ctx.font='16px Arial'; ctx.textAlign='left';
  ctx.fillText(`üçì ${score} / ${collectibles.length}`,12,24);
  ctx.fillText(`‚ù§ ${lives}`,12,44);

  if(gameWon){
    ctx.fillStyle='rgba(255,209,232,0.9)'; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle='#7a1f5c'; ctx.font='28px Arial'; ctx.textAlign='center';
    ctx.fillText('üíñ Fim de fase! üíñ',canvas.width/2,canvas.height/2-20);
    ctx.font='18px Arial';
    ctx.fillText(`Voc√™ coletou ${score} morangos üçì`,canvas.width/2,canvas.height/2+15);
  }

  if(gameOver){
    ctx.fillStyle='rgba(0,0,0,0.7)'; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle='#ff4fa3'; ctx.font='32px Arial'; ctx.textAlign='center';
    ctx.fillText('üíî Game Over üíî',canvas.width/2,canvas.height/2-20);
    ctx.font='18px Arial';
    ctx.fillText(`Voc√™ coletou ${score} morangos üçì`,canvas.width/2,canvas.height/2+15);
  }
}

function loop(){ update(); draw(); requestAnimationFrame(loop); }
playerImg.onload = loop;
</script>
</body>
</html>
